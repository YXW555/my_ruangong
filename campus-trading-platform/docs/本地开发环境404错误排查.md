# 本地开发环境 404 错误排查

## 问题现象

请求发送到 `http://localhost:8081/api/idle/lable`，返回 404。

## 原因分析

1. **代理没有生效**：请求直接发送到了 `localhost:8081`，说明 `vue.config.js` 的代理配置没有生效
2. **后端服务可能没有运行**
3. **后端接口路径问题**

## 立即排查

### 第 1 步：检查后端服务是否运行

```bash
cd campus-trading-platform
docker-compose ps
```

应该看到 `campus-trading-backend` 容器在运行。

### 第 2 步：测试后端接口

```bash
# 直接测试后端接口（不通过代理）
curl http://localhost:8081/idle/lable?idleLabel=1&page=1&nums=8
```

如果返回 404，说明后端接口路径有问题。

### 第 3 步：检查代理配置

确认 `vue.config.js` 配置正确，并且**前端开发服务器已重启**。

### 第 4 步：检查后端日志

```bash
docker-compose logs backend | tail -20
```

## 解决方案

### 方案 1：重启前端开发服务器（最重要！）

**必须重启**前端开发服务器，让 `vue.config.js` 的代理配置生效：

```bash
# 1. 停止前端开发服务器（Ctrl+C）

# 2. 重新启动
cd campus-trading-platform/frontend
npm run serve
```

### 方案 2：检查后端服务

```bash
# 检查后端是否运行
docker-compose ps backend

# 如果没有运行，启动
docker-compose up -d backend

# 查看后端日志
docker-compose logs backend | tail -30
```

### 方案 3：直接测试后端

```bash
# 测试后端接口（注意：没有 /api 前缀）
curl "http://localhost:8081/idle/lable?idleLabel=1&page=1&nums=8"
```

如果这个能返回数据，说明后端正常，问题在代理配置。

## 完整排查流程

```bash
# === 1. 检查后端服务 ===
cd campus-trading-platform
docker-compose ps

# === 2. 测试后端接口（直接访问，不通过代理）===
curl "http://localhost:8081/idle/lable?idleLabel=1&page=1&nums=8" 2>&1 | head -20

# === 3. 查看后端日志 ===
docker-compose logs backend | tail -30

# === 4. 检查前端代理配置 ===
cat frontend/vue.config.js | grep -A 10 "devServer"
```

## 如果后端接口正常

如果直接访问 `http://localhost:8081/idle/lable` 能返回数据，但通过代理不行，说明代理配置有问题。

**检查**：
1. 前端开发服务器是否重启
2. `vue.config.js` 配置是否正确
3. 浏览器是否缓存了旧配置

**解决**：
1. 完全停止前端开发服务器
2. 清除浏览器缓存
3. 重新启动前端开发服务器
4. 硬刷新页面（Ctrl+Shift+R）

