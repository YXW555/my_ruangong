# 快速迁移检查清单（从组长仓库到个人仓库）

## 🎯 核心原则

- **服务器是同一个** → 服务器端配置大部分不需要重复
- **GitHub 仓库不同** → GitHub 配置必须重新做
- **Docker Hub 可能不同** → 可能需要更新镜像名称

---

## ✅ 3 个必须做的操作（按顺序）

### 1️⃣ 配置你的 GitHub Secrets（10分钟）

**必须做**：因为这是不同的 GitHub 仓库

1. 进入你的 GitHub 仓库
2. **Settings** → **Secrets and variables** → **Actions**
3. 添加以下 Secrets：

```
DOCKER_USERNAME = 你的Docker Hub用户名
DOCKER_PASSWORD = 你的Docker Hub密码/令牌
HOST = 服务器IP（和组长的一样）
USERNAME = root
SSH_KEY = SSH私钥内容（如果使用同一个密钥，复制组长的值）
```

**提示**：
- 如果使用**同一个 SSH 密钥**，`SSH_KEY` 可以直接复制组长仓库中的值
- 如果使用**同一个 Docker Hub 账号**，`DOCKER_USERNAME` 和 `DOCKER_PASSWORD` 也相同

---

### 2️⃣ 更新服务器配置（如果需要，5分钟）

**可能需要做**：取决于 Docker Hub 用户名是否相同

#### 情况 A：Docker Hub 用户名和组长一样

✅ **无需操作**，直接跳过

#### 情况 B：Docker Hub 用户名不同

需要更新服务器上的 `docker-compose.yml`：

```bash
# 连接服务器
ssh root@你的服务器IP

# 编辑配置文件
cd /opt/campus-trading-platform
nano docker-compose.yml
```

**修改这两处**：
- `backend` 服务的 `image`: `你的Docker用户名/campus-trading-backend:latest`
- `frontend` 服务的 `image`: `你的Docker用户名/campus-trading-frontend:latest`

**或者**使用环境变量（推荐，docker-compose.prod.yml 已支持）：

```bash
# 在服务器上设置环境变量
export DOCKER_USERNAME=你的Docker用户名
cd /opt/campus-trading-platform
docker-compose up -d
```

---

### 3️⃣ 推送代码并触发 CI/CD（5分钟）

**必须做**：代码需要推送到你的仓库

```bash
# 在 D:/git/my_ruangong/campus-trading-platform 目录下

# 检查远程仓库
git remote -v

# 如果指向组长的仓库，更新它
git remote set-url origin https://github.com/你的用户名/你的仓库名.git

# 推送代码
git add .
git commit -m "配置 CI/CD 到个人仓库"
git push origin main
```

---

## ❌ 不需要重复做的操作

以下操作因为使用同一个服务器，**不需要重复**：

- ✅ 服务器初始化（Docker 安装等）
- ✅ SSH 密钥添加到服务器（如果使用同一个密钥）
- ✅ 安全组配置
- ✅ 服务器目录创建

---

## 🔍 快速判断表

| 情况 | 需要做什么 |
|------|-----------|
| **Docker Hub 用户名相同 + SSH 密钥相同** | 只需：1. 配置 GitHub Secrets 2. 推送代码 |
| **Docker Hub 用户名不同 + SSH 密钥相同** | 需要：1. 配置 GitHub Secrets 2. 更新服务器配置 3. 推送代码 |
| **Docker Hub 用户名相同 + SSH 密钥不同** | 需要：1. 配置 GitHub Secrets（包括新SSH_KEY）2. 添加新密钥到服务器 3. 推送代码 |
| **Docker Hub 用户名不同 + SSH 密钥不同** | 需要：1. 配置 GitHub Secrets 2. 添加新密钥到服务器 3. 更新服务器配置 4. 推送代码 |

---

## 🚀 最快路径（如果使用相同的 Docker Hub 和 SSH 密钥）

如果你和组长使用：
- ✅ 同一个 Docker Hub 账号
- ✅ 同一个 SSH 密钥对

那么你只需要：

1. **配置 GitHub Secrets**（复制组长的值，除了 HOST 和 USERNAME 可能不同）
2. **推送代码到你的仓库**

**总时间：约 10 分钟**

---

## 📋 验证步骤

完成后验证：

1. **GitHub Actions 运行**
   - 进入你的 GitHub 仓库 → **Actions**
   - 应该能看到工作流运行

2. **服务器服务运行**
   ```bash
   ssh root@你的服务器IP
   cd /opt/campus-trading-platform
   docker-compose ps
   ```

3. **访问测试**
   - 前端：`http://你的服务器IP`
   - 后端：`http://你的服务器IP:8080`

---

**完成！** 🎉

