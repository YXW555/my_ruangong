# 修复镜像名称问题（yourusername 未替换）

## 问题现象

执行 `docker compose pull` 时，错误信息显示：
```
failed to resolve reference "docker.io/yourusername/campus-trading-backend:latest": 403 Forbidden
```

这说明 `docker-compose.yml` 文件中的 `yourusername` 占位符没有被替换成实际的 Docker Hub 用户名。

## 原因

`docker-compose.yml` 文件使用了 `${DOCKER_USERNAME:-yourusername}`，但环境变量没有正确传递。

## 解决方案

### 方法 1：直接修改 docker-compose.yml 文件（最简单，推荐）

```bash
cd /opt/campus-trading-platform

# 查看当前配置
grep "image:" docker-compose.yml

# 直接替换 yourusername 为你的 Docker Hub 用户名
sudo sed -i 's/yourusername/yxw555/g' docker-compose.yml

# 验证修改
grep "image:" docker-compose.yml

# 现在应该显示：
# image: yxw555/campus-trading-backend:latest
# image: yxw555/campus-trading-frontend:latest

# 然后拉取镜像
sudo docker compose pull
```

### 方法 2：使用环境变量文件

```bash
cd /opt/campus-trading-platform

# 创建 .env 文件
echo "DOCKER_USERNAME=yxw555" | sudo tee .env

# 然后使用 docker compose
sudo docker compose pull
```

### 方法 3：在命令中直接设置环境变量

```bash
cd /opt/campus-trading-platform

# 在命令前设置环境变量
DOCKER_USERNAME=yxw555 sudo -E docker compose pull
```

## 推荐操作（一步到位）

```bash
cd /opt/campus-trading-platform

# 1. 直接替换占位符
sudo sed -i 's/yourusername/yxw555/g' docker-compose.yml

# 2. 验证修改
cat docker-compose.yml | grep image

# 3. 拉取镜像
sudo docker compose pull

# 4. 启动服务
sudo docker compose up -d

# 5. 查看状态
sudo docker compose ps

# 6. 查看日志
sudo docker compose logs -f
```

## 验证修复

```bash
# 检查配置
sudo docker compose config | grep image

# 应该显示：
# image: yxw555/campus-trading-backend:latest
# image: yxw555/campus-trading-frontend:latest
# 而不是 yourusername
```

## 如果镜像不存在

如果拉取时提示镜像不存在，说明：
1. 镜像还没有推送到 Docker Hub
2. 或者 Docker Hub 用户名不对

**检查镜像是否存在**：
```bash
# 在浏览器访问
https://hub.docker.com/r/yxw555/campus-trading-backend
https://hub.docker.com/r/yxw555/campus-trading-frontend

# 或者使用命令检查
curl -s https://hub.docker.com/v2/repositories/yxw555/campus-trading-backend/ | grep -o '"name":"[^"]*"' | head -1
```

**如果镜像不存在，需要先推送**：
- 检查 GitHub Actions 是否成功构建并推送了镜像
- 或者手动构建并推送镜像

