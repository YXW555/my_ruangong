{"remainingRequest":"D:\\Git\\ruangong\\campus-trading-platform\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Git\\ruangong\\campus-trading-platform\\frontend\\src\\components\\page\\merchant-apply.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Git\\ruangong\\campus-trading-platform\\frontend\\src\\components\\page\\merchant-apply.vue","mtime":1766649102813},{"path":"D:\\Git\\ruangong\\campus-trading-platform\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678197338000},{"path":"D:\\Git\\ruangong\\campus-trading-platform\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1678197338000},{"path":"D:\\Git\\ruangong\\campus-trading-platform\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678197338000},{"path":"D:\\Git\\ruangong\\campus-trading-platform\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":1678197338000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport AppHead from '../common/AppHeader.vue';\nimport AppBody from '../common/AppPageBody.vue';\nimport AppFoot from '../common/AppFoot.vue';\n\nexport default {\n    name: \"merchant-apply\",\n    components: {\n        AppHead,\n        AppBody,\n        AppFoot\n    },\n    data() {\n        return {\n            applicationForm: {\n                shopName: '',\n                contactPhone: '',\n                contactAddress: '',\n                idCardFront: '',\n                idCardBack: '',\n                businessLicense: '',\n                applicationReason: ''\n            },\n            applicationStatus: null,\n            submitting: false,\n            rules: {\n                shopName: [\n                    { required: true, message: '请输入店铺名称', trigger: 'blur' },\n                    { min: 2, max: 32, message: '长度在 2 到 32 个字符', trigger: 'blur' }\n                ],\n                contactPhone: [\n                    { required: true, message: '请输入联系电话', trigger: 'blur' },\n                    { pattern: /^1[3-9]\\d{9}$/, message: '请输入正确的手机号码', trigger: 'blur' }\n                ],\n                contactAddress: [\n                    { required: true, message: '请输入联系地址', trigger: 'blur' },\n                    { min: 5, max: 128, message: '长度在 5 到 128 个字符', trigger: 'blur' }\n                ],\n                idCardFront: [\n                    { required: true, message: '请上传身份证正面', trigger: 'change' }\n                ],\n                idCardBack: [\n                    { required: true, message: '请上传身份证反面', trigger: 'change' }\n                ],\n                applicationReason: [\n                    { max: 512, message: '最多512个字符', trigger: 'blur' }\n                ]\n            }\n        };\n    },\n    created() {\n        this.loadApplicationStatus();\n    },\n    methods: {\n        loadApplicationStatus() {\n            this.$api.getMyMerchantApplication().then(res => {\n                if (res.status_code === 1 && res.data) {\n                    this.applicationStatus = res.data;\n                    if (res.data.status === 0) {\n                        // 待审核状态，填充表单数据\n                        this.applicationForm = {\n                            shopName: res.data.shopName || '',\n                            contactPhone: res.data.contactPhone || '',\n                            contactAddress: res.data.contactAddress || '',\n                            idCardFront: res.data.idCardFront || '',\n                            idCardBack: res.data.idCardBack || '',\n                            businessLicense: res.data.businessLicense || '',\n                            applicationReason: res.data.applicationReason || ''\n                        };\n                    }\n                }\n            }).catch(() => {\n            });\n        },\n        handleImageSuccess(res, field) {\n            if (res.status_code === 1) {\n                this.applicationForm[field] = res.data;\n                this.$refs.applicationForm.validateField(field);\n            } else {\n                this.$message.error('图片上传失败');\n            }\n        },\n        submitApplication() {\n            this.$refs.applicationForm.validate((valid) => {\n                if (valid) {\n                    this.submitting = true;\n                    this.$api.submitMerchantApplication(this.applicationForm).then(res => {\n                        if (res.status_code === 1) {\n                            this.$message({\n                                message: '申请提交成功，请等待审核！',\n                                type: 'success'\n                            });\n                            this.loadApplicationStatus();\n                        } else {\n                            this.$message.error('申请提交失败：' + (res.msg || '未知错误'));\n                        }\n                    }).catch(() => {\n                        this.$message.error('申请提交失败！');\n                    }).finally(() => {\n                        this.submitting = false;\n                    });\n                }\n            });\n        },\n        resetForm() {\n            this.$refs.applicationForm.resetFields();\n        },\n        getStatusTitle() {\n            if (!this.applicationStatus) return '';\n            const status = this.applicationStatus.status;\n            if (status === 0) return '审核中';\n            if (status === 1) return '审核通过';\n            if (status === 2) return '审核未通过';\n            return '';\n        },\n        getStatusType() {\n            if (!this.applicationStatus) return 'info';\n            const status = this.applicationStatus.status;\n            if (status === 0) return 'warning';\n            if (status === 1) return 'success';\n            if (status === 2) return 'error';\n            return 'info';\n        },\n        getStatusDescription() {\n            if (!this.applicationStatus) return '';\n            const status = this.applicationStatus.status;\n            if (status === 0) {\n                return '您的申请正在审核中，请耐心等待...';\n            }\n            if (status === 1) {\n                return '恭喜！您已成为经营性卖家，可以享受批量发布、库存管理等高级功能。';\n            }\n            if (status === 2) {\n                return this.applicationStatus.adminComment || '很抱歉，您的申请未通过审核，可以重新提交申请。';\n            }\n            return '';\n        }\n    }\n}\n",{"version":3,"sources":["merchant-apply.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyIA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"merchant-apply.vue","sourceRoot":"src/components/page","sourcesContent":["<template>\r\n    <div>\r\n        <app-head></app-head>\r\n        <app-body>\r\n            <div class=\"merchant-apply-container\">\r\n                <el-card class=\"apply-card\" shadow=\"hover\">\r\n                    <div slot=\"header\" class=\"card-header\">\r\n                        <span><i class=\"el-icon-s-shop\"></i> 商家认证申请</span>\r\n                    </div>\r\n\r\n                    <!-- 申请状态提示 -->\r\n                    <div v-if=\"applicationStatus\" class=\"status-info\">\r\n                        <el-alert\r\n                            :title=\"getStatusTitle()\"\r\n                            :type=\"getStatusType()\"\r\n                            :description=\"getStatusDescription()\"\r\n                            show-icon\r\n                            :closable=\"false\">\r\n                        </el-alert>\r\n                    </div>\r\n\r\n                    <!-- 申请表单 -->\r\n                    <el-form\r\n                        :model=\"applicationForm\"\r\n                        :rules=\"rules\"\r\n                        ref=\"applicationForm\"\r\n                        label-width=\"120px\"\r\n                        class=\"apply-form\"\r\n                        v-if=\"!applicationStatus || applicationStatus.status === 2\">\r\n                        <el-form-item label=\"店铺名称\" prop=\"shopName\">\r\n                            <el-input\r\n                                v-model=\"applicationForm.shopName\"\r\n                                placeholder=\"请输入店铺名称\"\r\n                                maxlength=\"32\"\r\n                                show-word-limit>\r\n                            </el-input>\r\n                        </el-form-item>\r\n\r\n                        <el-form-item label=\"联系电话\" prop=\"contactPhone\">\r\n                            <el-input\r\n                                v-model=\"applicationForm.contactPhone\"\r\n                                placeholder=\"请输入联系电话\"\r\n                                maxlength=\"16\">\r\n                            </el-input>\r\n                        </el-form-item>\r\n\r\n                        <el-form-item label=\"联系地址\" prop=\"contactAddress\">\r\n                            <el-input\r\n                                v-model=\"applicationForm.contactAddress\"\r\n                                type=\"textarea\"\r\n                                :rows=\"2\"\r\n                                placeholder=\"请输入详细联系地址\"\r\n                                maxlength=\"128\"\r\n                                show-word-limit>\r\n                            </el-input>\r\n                        </el-form-item>\r\n\r\n                        <el-form-item label=\"身份证正面\" prop=\"idCardFront\">\r\n                            <el-upload\r\n                                action=\"http://localhost:8080/file/\"\r\n                                :on-success=\"(res) => handleImageSuccess(res, 'idCardFront')\"\r\n                                :show-file-list=\"false\"\r\n                                accept=\"image/*\"\r\n                                class=\"image-uploader\">\r\n                                <el-image\r\n                                    v-if=\"applicationForm.idCardFront\"\r\n                                    :src=\"applicationForm.idCardFront\"\r\n                                    fit=\"cover\"\r\n                                    class=\"uploaded-image\">\r\n                                </el-image>\r\n                                <i v-else class=\"el-icon-plus image-uploader-icon\"></i>\r\n                            </el-upload>\r\n                            <div class=\"upload-tip\">请上传身份证正面照片</div>\r\n                        </el-form-item>\r\n\r\n                        <el-form-item label=\"身份证反面\" prop=\"idCardBack\">\r\n                            <el-upload\r\n                                action=\"http://localhost:8080/file/\"\r\n                                :on-success=\"(res) => handleImageSuccess(res, 'idCardBack')\"\r\n                                :show-file-list=\"false\"\r\n                                accept=\"image/*\"\r\n                                class=\"image-uploader\">\r\n                                <el-image\r\n                                    v-if=\"applicationForm.idCardBack\"\r\n                                    :src=\"applicationForm.idCardBack\"\r\n                                    fit=\"cover\"\r\n                                    class=\"uploaded-image\">\r\n                                </el-image>\r\n                                <i v-else class=\"el-icon-plus image-uploader-icon\"></i>\r\n                            </el-upload>\r\n                            <div class=\"upload-tip\">请上传身份证反面照片</div>\r\n                        </el-form-item>\r\n\r\n                        <el-form-item label=\"营业执照\" prop=\"businessLicense\">\r\n                            <el-upload\r\n                                action=\"http://localhost:8080/file/\"\r\n                                :on-success=\"(res) => handleImageSuccess(res, 'businessLicense')\"\r\n                                :show-file-list=\"false\"\r\n                                accept=\"image/*\"\r\n                                class=\"image-uploader\">\r\n                                <el-image\r\n                                    v-if=\"applicationForm.businessLicense\"\r\n                                    :src=\"applicationForm.businessLicense\"\r\n                                    fit=\"cover\"\r\n                                    class=\"uploaded-image\">\r\n                                </el-image>\r\n                                <i v-else class=\"el-icon-plus image-uploader-icon\"></i>\r\n                            </el-upload>\r\n                            <div class=\"upload-tip\">请上传营业执照（可选）</div>\r\n                        </el-form-item>\r\n\r\n                        <el-form-item label=\"申请理由\" prop=\"applicationReason\">\r\n                            <el-input\r\n                                v-model=\"applicationForm.applicationReason\"\r\n                                type=\"textarea\"\r\n                                :rows=\"4\"\r\n                                placeholder=\"请简要说明申请成为经营性卖家的理由...\"\r\n                                maxlength=\"512\"\r\n                                show-word-limit>\r\n                            </el-input>\r\n                        </el-form-item>\r\n\r\n                        <el-form-item>\r\n                            <el-button type=\"primary\" icon=\"el-icon-check\" @click=\"submitApplication\" :loading=\"submitting\">\r\n                                提交申请\r\n                            </el-button>\r\n                            <el-button @click=\"resetForm\">重置</el-button>\r\n                        </el-form-item>\r\n                    </el-form>\r\n                </el-card>\r\n            </div>\r\n            <app-foot></app-foot>\r\n        </app-body>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import AppHead from '../common/AppHeader.vue';\r\n    import AppBody from '../common/AppPageBody.vue';\r\n    import AppFoot from '../common/AppFoot.vue';\r\n\r\n    export default {\r\n        name: \"merchant-apply\",\r\n        components: {\r\n            AppHead,\r\n            AppBody,\r\n            AppFoot\r\n        },\r\n        data() {\r\n            return {\r\n                applicationForm: {\r\n                    shopName: '',\r\n                    contactPhone: '',\r\n                    contactAddress: '',\r\n                    idCardFront: '',\r\n                    idCardBack: '',\r\n                    businessLicense: '',\r\n                    applicationReason: ''\r\n                },\r\n                applicationStatus: null,\r\n                submitting: false,\r\n                rules: {\r\n                    shopName: [\r\n                        { required: true, message: '请输入店铺名称', trigger: 'blur' },\r\n                        { min: 2, max: 32, message: '长度在 2 到 32 个字符', trigger: 'blur' }\r\n                    ],\r\n                    contactPhone: [\r\n                        { required: true, message: '请输入联系电话', trigger: 'blur' },\r\n                        { pattern: /^1[3-9]\\d{9}$/, message: '请输入正确的手机号码', trigger: 'blur' }\r\n                    ],\r\n                    contactAddress: [\r\n                        { required: true, message: '请输入联系地址', trigger: 'blur' },\r\n                        { min: 5, max: 128, message: '长度在 5 到 128 个字符', trigger: 'blur' }\r\n                    ],\r\n                    idCardFront: [\r\n                        { required: true, message: '请上传身份证正面', trigger: 'change' }\r\n                    ],\r\n                    idCardBack: [\r\n                        { required: true, message: '请上传身份证反面', trigger: 'change' }\r\n                    ],\r\n                    applicationReason: [\r\n                        { max: 512, message: '最多512个字符', trigger: 'blur' }\r\n                    ]\r\n                }\r\n            };\r\n        },\r\n        created() {\r\n            this.loadApplicationStatus();\r\n        },\r\n        methods: {\r\n            loadApplicationStatus() {\r\n                this.$api.getMyMerchantApplication().then(res => {\r\n                    if (res.status_code === 1 && res.data) {\r\n                        this.applicationStatus = res.data;\r\n                        if (res.data.status === 0) {\r\n                            // 待审核状态，填充表单数据\r\n                            this.applicationForm = {\r\n                                shopName: res.data.shopName || '',\r\n                                contactPhone: res.data.contactPhone || '',\r\n                                contactAddress: res.data.contactAddress || '',\r\n                                idCardFront: res.data.idCardFront || '',\r\n                                idCardBack: res.data.idCardBack || '',\r\n                                businessLicense: res.data.businessLicense || '',\r\n                                applicationReason: res.data.applicationReason || ''\r\n                            };\r\n                        }\r\n                    }\r\n                }).catch(() => {\r\n                });\r\n            },\r\n            handleImageSuccess(res, field) {\r\n                if (res.status_code === 1) {\r\n                    this.applicationForm[field] = res.data;\r\n                    this.$refs.applicationForm.validateField(field);\r\n                } else {\r\n                    this.$message.error('图片上传失败');\r\n                }\r\n            },\r\n            submitApplication() {\r\n                this.$refs.applicationForm.validate((valid) => {\r\n                    if (valid) {\r\n                        this.submitting = true;\r\n                        this.$api.submitMerchantApplication(this.applicationForm).then(res => {\r\n                            if (res.status_code === 1) {\r\n                                this.$message({\r\n                                    message: '申请提交成功，请等待审核！',\r\n                                    type: 'success'\r\n                                });\r\n                                this.loadApplicationStatus();\r\n                            } else {\r\n                                this.$message.error('申请提交失败：' + (res.msg || '未知错误'));\r\n                            }\r\n                        }).catch(() => {\r\n                            this.$message.error('申请提交失败！');\r\n                        }).finally(() => {\r\n                            this.submitting = false;\r\n                        });\r\n                    }\r\n                });\r\n            },\r\n            resetForm() {\r\n                this.$refs.applicationForm.resetFields();\r\n            },\r\n            getStatusTitle() {\r\n                if (!this.applicationStatus) return '';\r\n                const status = this.applicationStatus.status;\r\n                if (status === 0) return '审核中';\r\n                if (status === 1) return '审核通过';\r\n                if (status === 2) return '审核未通过';\r\n                return '';\r\n            },\r\n            getStatusType() {\r\n                if (!this.applicationStatus) return 'info';\r\n                const status = this.applicationStatus.status;\r\n                if (status === 0) return 'warning';\r\n                if (status === 1) return 'success';\r\n                if (status === 2) return 'error';\r\n                return 'info';\r\n            },\r\n            getStatusDescription() {\r\n                if (!this.applicationStatus) return '';\r\n                const status = this.applicationStatus.status;\r\n                if (status === 0) {\r\n                    return '您的申请正在审核中，请耐心等待...';\r\n                }\r\n                if (status === 1) {\r\n                    return '恭喜！您已成为经营性卖家，可以享受批量发布、库存管理等高级功能。';\r\n                }\r\n                if (status === 2) {\r\n                    return this.applicationStatus.adminComment || '很抱歉，您的申请未通过审核，可以重新提交申请。';\r\n                }\r\n                return '';\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n    .merchant-apply-container {\r\n        min-height: 85vh;\r\n        padding: 20px;\r\n    }\r\n\r\n    .apply-card {\r\n        max-width: 900px;\r\n        margin: 0 auto;\r\n    }\r\n\r\n    .card-header {\r\n        font-size: 18px;\r\n        font-weight: 600;\r\n    }\r\n\r\n    .status-info {\r\n        margin-bottom: 20px;\r\n    }\r\n\r\n    .apply-form {\r\n        padding: 20px 0;\r\n    }\r\n\r\n    .image-uploader {\r\n        border: 1px dashed #d9d9d9;\r\n        border-radius: 6px;\r\n        cursor: pointer;\r\n        position: relative;\r\n        overflow: hidden;\r\n        width: 178px;\r\n        height: 178px;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n    }\r\n\r\n    .image-uploader:hover {\r\n        border-color: #409EFF;\r\n    }\r\n\r\n    .image-uploader-icon {\r\n        font-size: 28px;\r\n        color: #8c939d;\r\n    }\r\n\r\n    .uploaded-image {\r\n        width: 178px;\r\n        height: 178px;\r\n    }\r\n\r\n    .upload-tip {\r\n        font-size: 12px;\r\n        color: #909399;\r\n        margin-top: 5px;\r\n    }\r\n</style>\r\n\r\n"]}]}