{"remainingRequest":"D:\\Git\\my_ruangong\\campus-trading-platform\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Git\\my_ruangong\\campus-trading-platform\\frontend\\src\\components\\common\\AfterSaleReview.vue?vue&type=template&id=33141fc7&scoped=true&","dependencies":[{"path":"D:\\Git\\my_ruangong\\campus-trading-platform\\frontend\\src\\components\\common\\AfterSaleReview.vue","mtime":1767334153608},{"path":"D:\\Git\\my_ruangong\\campus-trading-platform\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678197338000},{"path":"D:\\Git\\my_ruangong\\campus-trading-platform\\frontend\\node_modules\\vue-loader\\lib\\loaders\\templateLoader.js","mtime":1678197338000},{"path":"D:\\Git\\my_ruangong\\campus-trading-platform\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678197338000},{"path":"D:\\Git\\my_ruangong\\campus-trading-platform\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":1678197338000}],"contextDependencies":[],"result":["\n<div class=\"after-sale-review-container\">\n    <el-card shadow=\"never\">\n        <div slot=\"header\" class=\"clearfix\">\n            <span>售后申请审核</span>\n            <el-button style=\"float: right; padding: 3px 0\" type=\"text\" @click=\"loadAfterSales\">刷新</el-button>\n        </div>\n\n        <!-- 筛选条件 -->\n        <div class=\"filter-container\">\n            <el-radio-group v-model=\"filterStatus\" @change=\"handleStatusChange\" size=\"small\">\n                <el-radio-button :label=\"null\">全部</el-radio-button>\n                <el-radio-button :label=\"3\">待审核（卖家同意）</el-radio-button>\n                <el-radio-button :label=\"4\">待审核（卖家拒绝）</el-radio-button>\n                <el-radio-button :label=\"5\">已同意退款</el-radio-button>\n                <el-radio-button :label=\"6\">已驳回</el-radio-button>\n            </el-radio-group>\n        </div>\n\n        <!-- 售后申请列表 -->\n        <el-table\n            :data=\"afterSales\"\n            v-loading=\"loading\"\n            style=\"width: 100%\"\n            :header-cell-style=\"{ background: '#f5f7fa', color: '#303133', fontWeight: 'bold' }\"\n            border>\n            <el-table-column\n                prop=\"id\"\n                label=\"申请ID\"\n                width=\"80\">\n            </el-table-column>\n            <el-table-column\n                prop=\"order.orderNumber\"\n                label=\"订单号\"\n                width=\"180\"\n                show-overflow-tooltip>\n            </el-table-column>\n            <el-table-column\n                prop=\"order.idleItem.idleName\"\n                label=\"商品名称\"\n                show-overflow-tooltip>\n            </el-table-column>\n            <el-table-column\n                prop=\"buyer.nickname\"\n                label=\"买家\"\n                width=\"120\">\n            </el-table-column>\n            <el-table-column\n                prop=\"seller.nickname\"\n                label=\"卖家\"\n                width=\"120\">\n            </el-table-column>\n            <el-table-column\n                label=\"申请类型\"\n                width=\"120\">\n                <template slot-scope=\"scope\">\n                    <el-tag size=\"small\">{{ getApplicationTypeText(scope.row.applicationType) }}</el-tag>\n                </template>\n            </el-table-column>\n            <el-table-column\n                label=\"申请状态\"\n                width=\"140\">\n                <template slot-scope=\"scope\">\n                    <el-tag :type=\"getStatusType(scope.row.applicationStatus)\" size=\"small\">\n                        {{ getStatusText(scope.row.applicationStatus) }}\n                    </el-tag>\n                </template>\n            </el-table-column>\n            <el-table-column\n                prop=\"refundAmount\"\n                label=\"退款金额\"\n                width=\"120\">\n                <template slot-scope=\"scope\">\n                    ¥{{ scope.row.refundAmount }}\n                </template>\n            </el-table-column>\n            <el-table-column\n                prop=\"createTime\"\n                label=\"申请时间\"\n                width=\"160\">\n                <template slot-scope=\"scope\">\n                    {{ formatTime(scope.row.createTime) }}\n                </template>\n            </el-table-column>\n            <el-table-column\n                label=\"操作\"\n                width=\"200\"\n                fixed=\"right\">\n                <template slot-scope=\"scope\">\n                    <el-button\n                        size=\"mini\"\n                        type=\"primary\"\n                        @click=\"viewDetail(scope.row)\">\n                        查看详情\n                    </el-button>\n                    <el-button\n                        v-if=\"scope.row.applicationStatus === 3 || scope.row.applicationStatus === 4\"\n                        size=\"mini\"\n                        type=\"success\"\n                        @click=\"approveRefund(scope.row)\">\n                        同意退款\n                    </el-button>\n                    <el-button\n                        v-if=\"scope.row.applicationStatus === 3 || scope.row.applicationStatus === 4\"\n                        size=\"mini\"\n                        type=\"danger\"\n                        @click=\"rejectApplication(scope.row)\">\n                        驳回\n                    </el-button>\n                </template>\n            </el-table-column>\n        </el-table>\n    </el-card>\n\n    <!-- 详情对话框 -->\n    <el-dialog\n        title=\"售后申请详情\"\n        :visible.sync=\"detailDialogVisible\"\n        width=\"900px\"\n        @close=\"closeDetailDialog\">\n        <div v-if=\"currentAfterSale\" class=\"detail-content\">\n            <!-- 基本信息 -->\n            <el-card shadow=\"never\" class=\"detail-section\">\n                <div slot=\"header\">基本信息</div>\n                <el-row :gutter=\"20\">\n                    <el-col :span=\"12\">\n                        <p><strong>申请ID：</strong>{{ currentAfterSale.id }}</p>\n                        <p><strong>订单号：</strong>{{ currentAfterSale.order.orderNumber }}</p>\n                        <p><strong>商品名称：</strong>{{ currentAfterSale.order.idleItem.idleName }}</p>\n                        <p><strong>申请类型：</strong>{{ getApplicationTypeText(currentAfterSale.applicationType) }}</p>\n                    </el-col>\n                    <el-col :span=\"12\">\n                        <p><strong>买家：</strong>{{ currentAfterSale.buyer.nickname }}</p>\n                        <p><strong>卖家：</strong>{{ currentAfterSale.seller.nickname }}</p>\n                        <p><strong>退款金额：</strong><span style=\"color: #f56c6c; font-weight: bold;\">¥{{ currentAfterSale.refundAmount }}</span></p>\n                        <p><strong>申请时间：</strong>{{ formatTime(currentAfterSale.createTime) }}</p>\n                    </el-col>\n                </el-row>\n            </el-card>\n\n            <!-- 问题描述 -->\n            <el-card shadow=\"never\" class=\"detail-section\">\n                <div slot=\"header\">问题描述</div>\n                <p>{{ currentAfterSale.problemDescription }}</p>\n            </el-card>\n\n            <!-- 买家证据图片 -->\n            <el-card shadow=\"never\" class=\"detail-section\">\n                <div slot=\"header\">买家证据图片</div>\n                <div class=\"evidence-images\" v-if=\"buyerEvidenceImages.length > 0\">\n                    <el-image\n                        v-for=\"(img, index) in buyerEvidenceImages\"\n                        :key=\"index\"\n                        :src=\"img\"\n                        :preview-src-list=\"buyerEvidenceImages\"\n                        fit=\"cover\"\n                        class=\"evidence-image\">\n                    </el-image>\n                </div>\n                <p v-else style=\"color: #909399;\">暂无图片</p>\n            </el-card>\n\n            <!-- 卖家审核信息 -->\n            <el-card shadow=\"never\" class=\"detail-section\" v-if=\"currentAfterSale.sellerReviewTime\">\n                <div slot=\"header\">卖家审核信息</div>\n                <p><strong>审核结果：</strong>\n                    <el-tag :type=\"currentAfterSale.sellerReviewResult === 1 ? 'success' : 'danger'\" size=\"small\">\n                        {{ currentAfterSale.sellerReviewResult === 1 ? '同意' : '拒绝' }}\n                    </el-tag>\n                </p>\n                <p v-if=\"currentAfterSale.sellerRejectReason\"><strong>拒绝原因：</strong>{{ currentAfterSale.sellerRejectReason }}</p>\n                <p><strong>审核时间：</strong>{{ formatTime(currentAfterSale.sellerReviewTime) }}</p>\n                <div v-if=\"sellerEvidenceImages.length > 0\" class=\"evidence-images\">\n                    <p><strong>卖家举证图片：</strong></p>\n                    <el-image\n                        v-for=\"(img, index) in sellerEvidenceImages\"\n                        :key=\"index\"\n                        :src=\"img\"\n                        :preview-src-list=\"sellerEvidenceImages\"\n                        fit=\"cover\"\n                        class=\"evidence-image\">\n                    </el-image>\n                </div>\n            </el-card>\n\n            <!-- 聊天记录 -->\n            <el-card shadow=\"never\" class=\"detail-section\">\n                <div slot=\"header\">\n                    交易聊天记录\n                    <el-button size=\"mini\" type=\"text\" @click=\"loadChatMessages\" style=\"float: right;\">刷新</el-button>\n                </div>\n                <div class=\"chat-messages\" v-loading=\"chatLoading\">\n                    <div v-if=\"chatMessages.length === 0\" style=\"color: #909399; text-align: center; padding: 20px;\">\n                        <p>管理员无法直接查看聊天记录</p>\n                        <p style=\"font-size: 12px; margin-top: 10px;\">\n                            如需查看聊天记录，可要求买家或卖家提供聊天截图作为证据，或从相关用户账户查看\n                        </p>\n                        <p style=\"font-size: 12px; margin-top: 5px;\">\n                            买家ID: {{ currentAfterSale.buyerId }} | 卖家ID: {{ currentAfterSale.sellerId }}\n                        </p>\n                    </div>\n                    <div v-else>\n                        <div\n                            v-for=\"msg in chatMessages\"\n                            :key=\"msg.id\"\n                            class=\"chat-message-item\">\n                            <div class=\"chat-message-header\">\n                                <span class=\"chat-user\">{{ msg.fromU && msg.fromU.nickname || '未知用户' }}</span>\n                                <span class=\"chat-time\">{{ formatTime(msg.createTime) }}</span>\n                            </div>\n                            <div class=\"chat-message-content\">\n                                <el-image\n                                    v-if=\"msg.imageUrl\"\n                                    :src=\"msg.imageUrl\"\n                                    :preview-src-list=\"[msg.imageUrl]\"\n                                    fit=\"cover\"\n                                    class=\"chat-image\">\n                                </el-image>\n                                <div v-else v-html=\"msg.content\"></div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </el-card>\n        </div>\n        <span slot=\"footer\" class=\"dialog-footer\" v-if=\"currentAfterSale && (currentAfterSale.applicationStatus === 3 || currentAfterSale.applicationStatus === 4)\">\n            <el-button @click=\"detailDialogVisible = false\">关 闭</el-button>\n            <el-button type=\"success\" @click=\"approveRefund(currentAfterSale)\">同意退款</el-button>\n            <el-button type=\"danger\" @click=\"rejectApplication(currentAfterSale)\">驳回申请</el-button>\n        </span>\n        <span slot=\"footer\" class=\"dialog-footer\" v-else>\n            <el-button @click=\"detailDialogVisible = false\">关 闭</el-button>\n        </span>\n    </el-dialog>\n\n    <!-- 驳回对话框 -->\n    <el-dialog\n        title=\"驳回售后申请\"\n        :visible.sync=\"rejectDialogVisible\"\n        width=\"500px\">\n        <el-form :model=\"rejectForm\" :rules=\"rejectRules\" ref=\"rejectForm\" label-width=\"100px\">\n            <el-form-item label=\"驳回原因\" prop=\"reason\">\n                <el-input\n                    type=\"textarea\"\n                    :rows=\"4\"\n                    v-model=\"rejectForm.reason\"\n                    placeholder=\"请填写驳回原因，说明为什么驳回该申请...\"\n                    maxlength=\"500\"\n                    show-word-limit>\n                </el-input>\n            </el-form-item>\n        </el-form>\n        <span slot=\"footer\" class=\"dialog-footer\">\n            <el-button @click=\"rejectDialogVisible = false\">取 消</el-button>\n            <el-button type=\"danger\" @click=\"submitReject\" :loading=\"rejectSubmitting\">确 定</el-button>\n        </span>\n    </el-dialog>\n</div>\n",null]}