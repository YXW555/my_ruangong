{"remainingRequest":"D:\\Git\\my_ruangong\\campus-trading-platform\\frontend\\node_modules\\babel-loader\\lib\\index.js!D:\\Git\\my_ruangong\\campus-trading-platform\\frontend\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\Git\\my_ruangong\\campus-trading-platform\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Git\\my_ruangong\\campus-trading-platform\\frontend\\src\\components\\page\\alipay-success.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Git\\my_ruangong\\campus-trading-platform\\frontend\\src\\components\\page\\alipay-success.vue","mtime":1767056636466},{"path":"D:\\Git\\my_ruangong\\campus-trading-platform\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678197338000},{"path":"D:\\Git\\my_ruangong\\campus-trading-platform\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1678197338000},{"path":"D:\\Git\\my_ruangong\\campus-trading-platform\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678197338000},{"path":"D:\\Git\\my_ruangong\\campus-trading-platform\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":1678197338000},{"path":"D:\\Git\\my_ruangong\\campus-trading-platform\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678197338000},{"path":"D:\\Git\\my_ruangong\\campus-trading-platform\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1678197338000},{"path":"D:\\Git\\my_ruangong\\campus-trading-platform\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678197338000},{"path":"D:\\Git\\my_ruangong\\campus-trading-platform\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":1678197338000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"D:/Git/my_ruangong/campus-trading-platform/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"D:/Git/my_ruangong/campus-trading-platform/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\nimport \"core-js/modules/es6.regexp.split\";\nimport _defineProperty from \"D:/Git/my_ruangong/campus-trading-platform/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport AppHead from \"../common/AppHeader.vue\";\nimport AppBody from \"../common/AppPageBody.vue\";\nimport AppFoot from \"../common/AppFoot.vue\";\nexport default {\n  name: 'AlipaySuccess',\n  components: {\n    AppHead: AppHead,\n    AppBody: AppBody,\n    AppFoot: AppFoot\n  },\n  data: function data() {\n    return {\n      orderNo: '未知订单',\n      price: '0.00',\n      orderId: '',\n      orderType: '',\n      isLoading: true,\n      // 加载状态\n      hasError: false,\n      // 错误状态\n      countdown: 10,\n      // 自动跳转倒计时\n      timer: null // 倒计时定时器\n\n    };\n  },\n  mounted: function mounted() {\n    this.parseUrlParams();\n    this.initCountdown(); // 初始化自动跳转\n  },\n  beforeDestroy: function beforeDestroy() {\n    // 清除定时器\n    if (this.timer) clearInterval(this.timer);\n  },\n  methods: {\n    // 解析URL参数（增强健壮性）\n    parseUrlParams: function parseUrlParams() {\n      try {\n        // 优先用路由参数，再用URL查询参数\n        var params = _objectSpread(_objectSpread({}, this.$route.query), this.getUrlQueryParams());\n\n        console.log('合并后的参数:', params); // 赋值并校验\n\n        this.orderId = params.id || params.orderId || '';\n        this.orderNo = params.no || params.orderNumber || '未知订单';\n        this.orderType = params.type || 'normal'; // 处理价格格式\n\n        var priceNum = parseFloat(params.price || params.amount || 0);\n        this.price = isNaN(priceNum) ? '0.00' : priceNum.toFixed(2); // 会员订单激活\n\n        if (this.orderType === 'membership' && this.orderNo !== '未知订单') {\n          this.activateMembership();\n        }\n\n        this.isLoading = false; // 加载完成\n      } catch (error) {\n        console.error('解析URL参数出错:', error);\n        this.isLoading = false;\n        this.hasError = true;\n        this.$message.error('订单信息解析失败，请返回重试');\n      }\n    },\n    // 单独提取URL查询参数解析（兼容非路由场景）\n    getUrlQueryParams: function getUrlQueryParams() {\n      var queryPart = window.location.href.split('?')[1] || '';\n      return queryPart.split('&').reduce(function (acc, item) {\n        if (item.includes('=')) {\n          var _item$split = item.split('='),\n              _item$split2 = _slicedToArray(_item$split, 2),\n              key = _item$split2[0],\n              value = _item$split2[1];\n\n          acc[key] = decodeURIComponent(value || '');\n        }\n\n        return acc;\n      }, {});\n    },\n    // 激活会员（增加错误提示）\n    activateMembership: function () {\n      var _activateMembership = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var res;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return this.$api.activateMembership({\n                  orderNumber: this.orderNo\n                });\n\n              case 3:\n                res = _context.sent;\n\n                if (!(res.status_code === 1)) {\n                  _context.next = 10;\n                  break;\n                }\n\n                this.$message.success('会员权益已成功开通！');\n                _context.next = 8;\n                return this.refreshUserInfo();\n\n              case 8:\n                _context.next = 11;\n                break;\n\n              case 10:\n                this.$message.warning('会员开通延迟，请稍后查看会员页面');\n\n              case 11:\n                _context.next = 17;\n                break;\n\n              case 13:\n                _context.prev = 13;\n                _context.t0 = _context[\"catch\"](0);\n                console.error('会员激活失败:', _context.t0);\n                this.$message.warning('会员权益将稍后自动开通，请耐心等待');\n\n              case 17:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 13]]);\n      }));\n\n      function activateMembership() {\n        return _activateMembership.apply(this, arguments);\n      }\n\n      return activateMembership;\n    }(),\n    // 刷新用户信息（单独封装）\n    refreshUserInfo: function () {\n      var _refreshUserInfo = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n        var userRes;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (this.$globalData) {\n                  _context2.next = 2;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\");\n\n              case 2:\n                _context2.prev = 2;\n                _context2.next = 5;\n                return this.$api.getUserInfo();\n\n              case 5:\n                userRes = _context2.sent;\n\n                if (userRes.status_code === 1) {\n                  this.$globalData.userInfo = userRes.data;\n                }\n\n                _context2.next = 12;\n                break;\n\n              case 9:\n                _context2.prev = 9;\n                _context2.t0 = _context2[\"catch\"](2);\n                console.error('刷新用户信息失败:', _context2.t0);\n\n              case 12:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[2, 9]]);\n      }));\n\n      function refreshUserInfo() {\n        return _refreshUserInfo.apply(this, arguments);\n      }\n\n      return refreshUserInfo;\n    }(),\n    // 查看订单（优化路由跳转）\n    goToOrder: function goToOrder() {\n      var _this = this;\n\n      if (!this.orderId) {\n        this.$message.error('订单ID不存在，无法查看订单详情');\n        return;\n      } // 优先用路由跳转，兼容hash模式\n\n\n      this.$router.push({\n        path: '/order',\n        query: {\n          id: this.orderId\n        }\n      }).catch(function (err) {\n        // 路由跳转失败则用window.location\n        window.location.href = \"\".concat(window.location.origin, \"/#/order?id=\").concat(_this.orderId);\n      });\n    },\n    // 返回首页\n    goToHome: function goToHome() {\n      this.$router.push('/').catch(function () {\n        window.location.href = \"\".concat(window.location.origin, \"/#/\");\n      });\n    },\n    // 查看会员\n    goToMembership: function goToMembership() {\n      this.$router.push('/membership').catch(function () {\n        window.location.href = \"\".concat(window.location.origin, \"/#/membership\");\n      });\n    },\n    // 自动跳转倒计时\n    initCountdown: function initCountdown() {\n      var _this2 = this;\n\n      this.timer = setInterval(function () {\n        _this2.countdown--;\n\n        if (_this2.countdown <= 0) {\n          clearInterval(_this2.timer);\n\n          _this2.goToHome();\n        }\n      }, 1000);\n    }\n  }\n};",{"version":3,"sources":["alipay-success.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div>\r\n      <app-head></app-head>\r\n      <app-body>\r\n          <div class=\"payment-success-container\">\r\n              <!-- 加载状态 -->\r\n              <div v-if=\"isLoading\" class=\"loading-container\">\r\n                  <el-loading-spinner></el-loading-spinner>\r\n                  <p>正在加载订单信息...</p >\r\n              </div>\r\n\r\n              <!-- 错误状态 -->\r\n              <div v-else-if=\"hasError\" class=\"error-card\">\r\n                  <div class=\"error-icon\">\r\n                      <i class=\"el-icon-circle-close\"></i>\r\n                  </div>\r\n                  <h1 class=\"error-title\">订单信息加载失败</h1>\r\n                  <p class=\"error-desc\">请返回重新操作，或联系客服协助处理</p >\r\n                  <el-button type=\"primary\" round @click=\"goToHome\" icon=\"el-icon-s-home\">返回首页</el-button>\r\n              </div>\r\n\r\n              <!-- 成功状态 -->\r\n              <div v-else class=\"success-card\">\r\n                  <div class=\"success-icon\">\r\n                      <i class=\"el-icon-circle-check\"></i>\r\n                  </div>\r\n                  <h1 class=\"success-title\">支付成功</h1>\r\n\r\n                  <!-- 订单信息 -->\r\n                  <div class=\"order-info\">\r\n                      <p class=\"order-number\">订单号: {{ orderNo || '未知订单' }}</p >\r\n                      <p class=\"order-amount\">支付金额: <span class=\"price\">¥{{ price }}</span></p >\r\n                  </div>\r\n\r\n                  <!-- 描述信息 -->\r\n                  <div class=\"success-description\">\r\n                      <p v-if=\"orderType === 'membership'\">\r\n                          会员订单支付成功，<span class=\"highlight\">会员权益已立即生效</span>！\r\n                      </p >\r\n                      <template v-else>\r\n                          <p>您的订单已支付成功，感谢您的购买！</p >\r\n                          <p>卖家将在<span class=\"highlight\">24小时内</span>为您处理订单~</p >\r\n                      </template>\r\n                  </div>\r\n\r\n                  <!-- 操作按钮 -->\r\n                  <div class=\"action-buttons\">\r\n                      <el-button\r\n                              v-if=\"orderType !== 'membership'\"\r\n                              type=\"primary\"\r\n                              round\r\n                              @click=\"goToOrder\"\r\n                              icon=\"el-icon-document\"\r\n                              :disabled=\"!orderId\"\r\n                              class=\"primary-btn\"\r\n                      >\r\n                          查看订单\r\n                      </el-button>\r\n                      <el-button\r\n                              v-if=\"orderType === 'membership'\"\r\n                              type=\"primary\"\r\n                              round\r\n                              @click=\"goToMembership\"\r\n                              icon=\"el-icon-star-on\"\r\n                              class=\"primary-btn\"\r\n                      >\r\n                          查看会员\r\n                      </el-button>\r\n                      <el-button\r\n                              round\r\n                              @click=\"goToHome\"\r\n                              icon=\"el-icon-s-home\"\r\n                              class=\"secondary-btn\"\r\n                      >\r\n                          返回首页\r\n                      </el-button>\r\n                  </div>\r\n\r\n                  <!-- 倒计时提示 -->\r\n                  <div class=\"auto-redirect\" v-if=\"countdown > 0\">\r\n                      <p>将在 <span class=\"countdown-number\">{{ countdown }}</span> 秒后自动返回首页</p >\r\n                  </div>\r\n              </div>\r\n          </div>\r\n          <app-foot></app-foot>\r\n      </app-body>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport AppHead from '../common/AppHeader.vue';\r\nimport AppBody from '../common/AppPageBody.vue';\r\nimport AppFoot from '../common/AppFoot.vue';\r\n\r\nexport default {\r\n  name: 'AlipaySuccess',\r\n  components: {\r\n      AppHead,\r\n      AppBody,\r\n      AppFoot\r\n  },\r\n  data() {\r\n      return {\r\n          orderNo: '未知订单',\r\n          price: '0.00',\r\n          orderId: '',\r\n          orderType: '',\r\n          isLoading: true, // 加载状态\r\n          hasError: false, // 错误状态\r\n          countdown: 10, // 自动跳转倒计时\r\n          timer: null // 倒计时定时器\r\n      }\r\n  },\r\n  mounted() {\r\n      this.parseUrlParams();\r\n      this.initCountdown(); // 初始化自动跳转\r\n  },\r\n  beforeDestroy() {\r\n      // 清除定时器\r\n      if (this.timer) clearInterval(this.timer);\r\n  },\r\n  methods: {\r\n      // 解析URL参数（增强健壮性）\r\n      parseUrlParams() {\r\n          try {\r\n              // 优先用路由参数，再用URL查询参数\r\n              const params = { ...this.$route.query, ...this.getUrlQueryParams() };\r\n              console.log('合并后的参数:', params);\r\n\r\n              // 赋值并校验\r\n              this.orderId = params.id || params.orderId || '';\r\n              this.orderNo = params.no || params.orderNumber || '未知订单';\r\n              this.orderType = params.type || 'normal';\r\n\r\n              // 处理价格格式\r\n              const priceNum = parseFloat(params.price || params.amount || 0);\r\n              this.price = isNaN(priceNum) ? '0.00' : priceNum.toFixed(2);\r\n\r\n              // 会员订单激活\r\n              if (this.orderType === 'membership' && this.orderNo !== '未知订单') {\r\n                  this.activateMembership();\r\n              }\r\n\r\n              this.isLoading = false; // 加载完成\r\n          } catch (error) {\r\n              console.error('解析URL参数出错:', error);\r\n              this.isLoading = false;\r\n              this.hasError = true;\r\n              this.$message.error('订单信息解析失败，请返回重试');\r\n          }\r\n      },\r\n      // 单独提取URL查询参数解析（兼容非路由场景）\r\n      getUrlQueryParams() {\r\n          const queryPart = window.location.href.split('?')[1] || '';\r\n          return queryPart.split('&').reduce((acc, item) => {\r\n              if (item.includes('=')) {\r\n                  const [key, value] = item.split('=');\r\n                  acc[key] = decodeURIComponent(value || '');\r\n              }\r\n              return acc;\r\n          }, {});\r\n      },\r\n      // 激活会员（增加错误提示）\r\n      async activateMembership() {\r\n          try {\r\n              const res = await this.$api.activateMembership({ orderNumber: this.orderNo });\r\n              if (res.status_code === 1) {\r\n                  this.$message.success('会员权益已成功开通！');\r\n                  await this.refreshUserInfo(); // 刷新用户信息（异步处理）\r\n              } else {\r\n                  this.$message.warning('会员开通延迟，请稍后查看会员页面');\r\n              }\r\n          } catch (err) {\r\n              console.error('会员激活失败:', err);\r\n              this.$message.warning('会员权益将稍后自动开通，请耐心等待');\r\n          }\r\n      },\r\n      // 刷新用户信息（单独封装）\r\n      async refreshUserInfo() {\r\n          if (!this.$globalData) return;\r\n          try {\r\n              const userRes = await this.$api.getUserInfo();\r\n              if (userRes.status_code === 1) {\r\n                  this.$globalData.userInfo = userRes.data;\r\n              }\r\n          } catch (err) {\r\n              console.error('刷新用户信息失败:', err);\r\n          }\r\n      },\r\n      // 查看订单（优化路由跳转）\r\n      goToOrder() {\r\n          if (!this.orderId) {\r\n              this.$message.error('订单ID不存在，无法查看订单详情');\r\n              return;\r\n          }\r\n          // 优先用路由跳转，兼容hash模式\r\n          this.$router.push({ path: '/order', query: { id: this.orderId } }).catch(err => {\r\n              // 路由跳转失败则用window.location\r\n              window.location.href = `${window.location.origin}/#/order?id=${this.orderId}`;\r\n          });\r\n      },\r\n      // 返回首页\r\n      goToHome() {\r\n          this.$router.push('/').catch(() => {\r\n              window.location.href = `${window.location.origin}/#/`;\r\n          });\r\n      },\r\n      // 查看会员\r\n      goToMembership() {\r\n          this.$router.push('/membership').catch(() => {\r\n              window.location.href = `${window.location.origin}/#/membership`;\r\n          });\r\n      },\r\n      // 自动跳转倒计时\r\n      initCountdown() {\r\n          this.timer = setInterval(() => {\r\n              this.countdown--;\r\n              if (this.countdown <= 0) {\r\n                  clearInterval(this.timer);\r\n                  this.goToHome();\r\n              }\r\n          }, 1000);\r\n      }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n/* 全局容器 - 浅绿色主调背景 */\r\n.payment-success-container {\r\n  min-height: 85vh;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  background: linear-gradient(120deg, #f0f9f2 0%, #e8f5e9 100%);\r\n  padding: 20px;\r\n}\r\n\r\n/* 加载状态样式 */\r\n.loading-container {\r\n  text-align: center;\r\n  color: #4a7c59;\r\n}\r\n.loading-container .el-loading-spinner {\r\n  font-size: 40px;\r\n  margin-bottom: 10px;\r\n  color: #66bb6a;\r\n}\r\n.loading-container p {\r\n  font-size: 16px;\r\n  margin-top: 15px;\r\n}\r\n\r\n/* 错误状态样式 - 搭配浅绿色主调的错误提示 */\r\n.error-card {\r\n  background-color: #ffffff;\r\n  border-radius: 16px;\r\n  box-shadow: 0 8px 24px rgba(102, 187, 106, 0.1);\r\n  padding: 50px 40px;\r\n  text-align: center;\r\n  width: 100%;\r\n  max-width: 500px;\r\n  border: 1px solid #e8f5e9;\r\n}\r\n.error-icon {\r\n  font-size: 80px;\r\n  color: #ef5350;\r\n  margin-bottom: 20px;\r\n  opacity: 0.8;\r\n}\r\n.error-title {\r\n  font-size: 28px;\r\n  color: #2e7d32;\r\n  margin-bottom: 10px;\r\n  font-weight: 600;\r\n}\r\n.error-desc {\r\n  color: #558b2f;\r\n  margin-bottom: 30px;\r\n  font-size: 16px;\r\n  line-height: 1.5;\r\n}\r\n\r\n/* 成功卡片样式 - 浅绿色主调核心样式 */\r\n.success-card {\r\n  background-color: #ffffff;\r\n  border-radius: 16px;\r\n  box-shadow: 0 8px 32px rgba(102, 187, 106, 0.15);\r\n  padding: 50px 40px;\r\n  text-align: center;\r\n  width: 100%;\r\n  max-width: 500px;\r\n  border: 1px solid #dcedc8;\r\n  position: relative;\r\n  overflow: hidden;\r\n}\r\n/* 卡片顶部装饰条 */\r\n.success-card::before {\r\n  content: '';\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  height: 6px;\r\n  background: linear-gradient(90deg, #66bb6a 0%, #81c784 50%, #a5d6a7 100%);\r\n}\r\n.success-icon {\r\n  font-size: 90px;\r\n  color: #66bb6a;\r\n  margin-bottom: 25px;\r\n  animation: bounce 0.8s ease;\r\n  filter: drop-shadow(0 4px 8px rgba(102, 187, 106, 0.2));\r\n}\r\n.success-title {\r\n  font-size: 32px;\r\n  color: #2e7d32;\r\n  margin-bottom: 25px;\r\n  font-weight: 600;\r\n  letter-spacing: 0.5px;\r\n}\r\n.order-info {\r\n  background-color: #f9fcf9;\r\n  padding: 20px;\r\n  border-radius: 12px;\r\n  margin-bottom: 25px;\r\n  border: 1px solid #e8f5e9;\r\n  border-left: 4px solid #66bb6a;\r\n}\r\n.order-number, .order-amount {\r\n  margin: 12px 0;\r\n  color: #2e7d32;\r\n  font-size: 16px;\r\n}\r\n.price {\r\n  color: #2e7d32;\r\n  font-weight: 700;\r\n  font-size: 20px;\r\n}\r\n.success-description {\r\n  color: #4a7c59;\r\n  margin-bottom: 35px;\r\n  line-height: 1.8;\r\n  font-size: 16px;\r\n}\r\n.highlight {\r\n  color: #66bb6a;\r\n  font-weight: 600;\r\n}\r\n.action-buttons {\r\n  display: flex;\r\n  justify-content: center;\r\n  gap: 15px;\r\n  margin-bottom: 25px;\r\n  flex-wrap: wrap;\r\n}\r\n/* 主按钮样式 - 浅绿色系 */\r\n.primary-btn {\r\n  background-color: #66bb6a !important;\r\n  border-color: #66bb6a !important;\r\n  color: white !important;\r\n  padding: 12px 30px !important;\r\n  border-radius: 50px !important;\r\n  font-size: 15px !important;\r\n  font-weight: 500 !important;\r\n  box-shadow: 0 4px 12px rgba(102, 187, 106, 0.25) !important;\r\n  transition: all 0.3s ease !important;\r\n}\r\n.primary-btn:hover {\r\n  background-color: #558b2f !important;\r\n  border-color: #558b2f !important;\r\n  transform: translateY(-2px);\r\n  box-shadow: 0 6px 16px rgba(102, 187, 106, 0.3) !important;\r\n}\r\n.primary-btn:disabled {\r\n  background-color: #a5d6a7 !important;\r\n  border-color: #a5d6a7 !important;\r\n  box-shadow: none !important;\r\n  transform: none !important;\r\n}\r\n/* 次要按钮样式 */\r\n.secondary-btn {\r\n  background-color: #ffffff !important;\r\n  border-color: #c8e6c9 !important;\r\n  color: #2e7d32 !important;\r\n  padding: 12px 30px !important;\r\n  border-radius: 50px !important;\r\n  font-size: 15px !important;\r\n  font-weight: 500 !important;\r\n  transition: all 0.3s ease !important;\r\n}\r\n.secondary-btn:hover {\r\n  background-color: #f1f8e9 !important;\r\n  border-color: #a5d6a7 !important;\r\n  transform: translateY(-2px);\r\n  box-shadow: 0 4px 12px rgba(102, 187, 106, 0.15) !important;\r\n}\r\n/* 自动跳转样式 */\r\n.auto-redirect {\r\n  color: #81c784;\r\n  font-size: 14px;\r\n  margin-top: 10px;\r\n}\r\n.countdown-number {\r\n  color: #2e7d32;\r\n  font-weight: 700;\r\n  margin: 0 4px;\r\n  font-size: 15px;\r\n}\r\n\r\n/* 响应式优化 */\r\n@media (max-width: 768px) {\r\n  .success-card, .error-card {\r\n      padding: 35px 25px;\r\n      margin: 10px;\r\n  }\r\n  .success-icon, .error-icon {\r\n      font-size: 70px;\r\n  }\r\n  .success-title, .error-title {\r\n      font-size: 26px;\r\n  }\r\n  .action-buttons {\r\n      flex-direction: column;\r\n      gap: 12px;\r\n  }\r\n  .primary-btn, .secondary-btn {\r\n      width: 100%;\r\n  }\r\n}\r\n\r\n/* 成功图标动画 */\r\n@keyframes bounce {\r\n  0% { transform: scale(0.8); opacity: 0.7; }\r\n  50% { transform: scale(1.1); opacity: 1; }\r\n  100% { transform: scale(1); opacity: 1; }\r\n}\r\n\r\n/* 按钮点击反馈 */\r\n.el-button:focus {\r\n  outline: none !important;\r\n  box-shadow: 0 0 0 3px rgba(102, 187, 106, 0.2) !important;\r\n}\r\n</style>"],"sourceRoot":"src/components/page"}]}